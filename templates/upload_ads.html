<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Upload Advertisement</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body>
  <div class="container mt-5">
    <h2 class="text-center mb-4">Upload Your Advertisement</h2>
    <form action="/uploadAds" method="POST" enctype="multipart/form-data" id="adForm"
      class="shadow p-4 rounded bg-light">
      <!-- Company Name -->
      <div class="mb-3">
        <label for="company_name" class="form-label">Company Name</label>
        <input type="text" id="company_name" name="company_name" class="form-control"
          placeholder="Enter your company name" required />
      </div>

      <!-- Budget -->
      <div class="mb-3">
        <label for="budget" class="form-label">Budget (USD)</label>
        <input type="number" id="budget" name="budget" class="form-control" placeholder="Enter your budget" min="1"
          required />
      </div>

      <!-- Campaign Title -->
      <div class="mb-3">
        <label for="campaign_title" class="form-label">Campaign Title</label>
        <input type="text" id="campaign_title" name="campaign_title" class="form-control"
          placeholder="Enter your campaign title" required />
      </div>

      <!-- Target Audience -->
      <div class="mb-3">
        <label for="target_audience" class="form-label">Target Audience</label>
        <textarea id="target_audience" name="target_audience" class="form-control"
          placeholder="Describe your target audience" rows="3"></textarea>
      </div>

      <!-- Campaign Duration -->
      <div class="mb-3">
        <label for="start_date" class="form-label">Campaign Duration</label>
        <div class="row">
          <div class="col">
            <input type="date" id="start_date" name="start_date" class="form-control" required />
          </div>
          <div class="col">
            <input type="date" id="end_date" name="end_date" class="form-control" required />
          </div>
        </div>
      </div>

      <!-- Ad Category -->
      <div class="mb-3">
        <label for="ad_category" class="form-label">Ad Category</label>
        <select id="ad_category" name="ad_category" class="form-select" required>
          <option value="" disabled selected>Select a category</option>
          <option value="technology">Technology</option>
          <option value="food_beverage">Food & Beverage</option>
          <option value="retail">Retail</option>
          <option value="entertainment">Entertainment</option>
        </select>
      </div>

      <!-- Additional Notes -->
      <div class="mb-3">
        <label for="notes" class="form-label">Additional Notes</label>
        <textarea id="notes" name="notes" class="form-control" placeholder="Enter any additional details"
          rows="3"></textarea>
      </div>

      <!-- Video Upload -->
      <!-- <div class="mb-3">
        <label for="video_upload" class="form-label">Upload Advertisement Video</label>
        <input type="file" id="video" name="video" accept="video/*" class="form-control" required /><br /><br />
      </div> -->
      <!-- Media Upload -->
      <div class="mb-3">
        <label for="media_upload" class="form-label">Upload Advertisement Media</label>
        <input type="file" id="media" name="media" accept="video/*,image/*" class="form-control" required /><br /><br />
      </div>

      <!-- Submit Button -->
      <div class="text-center">
        <button type="submit" id="submitBtn" class="btn btn-primary">
          Submit
        </button>
      </div>
    </form>
  </div>
</body>

<body>
  <!-- Include this script to hash file names -->
  <script>
    async function hashFileName(file) {
      const fileName = file.name;
      const encoder = new TextEncoder();
      const data = encoder.encode(fileName);

      // Generate SHA-256 hash
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      const hashHex = hashArray
        .map((byte) => byte.toString(16).padStart(2, "0"))
        .join("");
      return hashHex + fileName.slice(fileName.lastIndexOf(".")); // Add original file extension
    }

    document.getElementById("video").addEventListener("change", async function (event) {
      const fileInput = event.target;
      const file = fileInput.files[0];
      if (file) {
        const hashedFileName = await hashFileName(file);
        console.log("Hashed File Name:", hashedFileName);

        // Optionally update the file input or form
        // You can send the hash along with the file data in the form submission
        const formData = new FormData();
        formData.append("fileName", hashedFileName);
        formData.append("file", file);

        // Simulate form submission
        // fetch('/upload', { method: 'POST', body: formData });
      }
    });
  </script>
</body>

</html>